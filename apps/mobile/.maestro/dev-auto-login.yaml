appId: host.exp.Exponent
---
# Dev Auto-Login Test
# Tests the @example.com auto-login flow that bypasses magic link
# NOTE: Run this test when logged out or it will test from logged-in state

# Launch the app
- launchApp

# If on Expo Go home screen, tap on Meet to open it
- runFlow:
    when:
      visible: "Recently opened"
    commands:
      - tapOn: "Meet"
      - extendedWaitUntil:
          notVisible: "Recently opened"
          timeout: 15000

# Dismiss Expo developer menu if visible - tap X button to close
- runFlow:
    when:
      visible: "SDK version"
    commands:
      - tapOn:
          point: "93%,37%"
      - waitForAnimationToEnd

# If already on nearby screen (logged in), go to profile and logout
- runFlow:
    when:
      visible: "W okolicy"
    commands:
      - tapOn: "Profil"
      - extendedWaitUntil:
          visible: "Wyloguj"
          timeout: 5000
      - tapOn: "Wyloguj"

# Wait for login screen
- extendedWaitUntil:
    visible:
      id: "email-input"
    timeout: 15000

# Should see login screen
- assertVisible: "Meet"
- assertVisible:
    id: "email-input"

# Clear any existing text and enter @example.com email
- tapOn:
    id: "email-input"
- eraseText: 50
- inputText: "test@example.com"
- hideKeyboard
- waitForAnimationToEnd

# Tap send - should auto-login without verification
- tapOn:
    text: "Wy≈õlij link"
    retryTapIfNoChange: true

# Should be redirected to main app (tabs)
- extendedWaitUntil:
    visible: "W okolicy"
    timeout: 10000

- assertVisible: "W okolicy"
